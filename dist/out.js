(()=>{let e="https://dinoosauro.github.io/pdf-pointer/";if(-1!==document.location.href.indexOf("netlify")&&(e="https://dinoosauro-pdf-pointer.netlify.app/"),"serviceWorker"in navigator){let t;(async()=>{t=await navigator.serviceWorker.register("./service-worker.js",{scope:e})})()}let t={toload:!0},n="1.1.1";fetch("https://dinoosauro.github.io/UpdateVersion/pdfpointer-updatecode",{cache:"no-store"}).then((e=>e.text().then((e=>{e.replace("\n","")!==n&&confirm(`There's a new version of pdf-pointer. Do you want to update? [${n} --\x3e ${e.replace("\n","")}]`)&&(caches.delete("pdfpointer-cache"),location.reload(!0))})).catch((e=>{console.error(e)})))).catch((e=>console.error(e))),fetch("./assets/mergedContent.json").then((e=>{e.json().then((e=>{t=e}))}));let o=[[document.documentElement.clientWidth,document.documentElement.clientHeight],[],[document.documentElement.clientWidth,document.documentElement.clientHeight]],a=new Event("close"),l=document.querySelectorAll("[customimg]");for(let e of l)e.addEventListener("close",(()=>unclickItems(e))),e.addEventListener("click",(()=>{if(e.classList.contains("clickImg")?unclickItems(e):clickItem(e),null!==e.getAttribute("disableAction")){let t=e.getAttribute("disableAction").split(",");for(let e of t)document.querySelector(`[data-action=${e}]`).classList.contains("clickImg")&&document.querySelector(`[data-action=${e}]`).dispatchEvent(a)}}));function clickItem(e){getImg([e.childNodes[1].src],`${e.getAttribute("data-action")}-fill`),e.classList.add("clickImg")}function unclickItems(e){getImg([e.childNodes[1].src],e.getAttribute("data-action")),e.classList.remove("clickImg")}let i={element:null,promise:null,page:1},r=!1,c="",d=[!1,"cursorpointer"],s=!1;function startPDFRead(e){document.getElementById("openDiv").classList.add("animate__animated","animate__backOutDown"),document.getElementById("intro").classList.add("animate__animated","animate__backOutDown"),setTimeout((()=>{document.getElementById("openDiv").remove(),document.getElementById("intro").remove(),document.getElementById("toolMain").style.visibility="visible",document.getElementById("pageContainer").style.visibility="visible",document.getElementById("toolMain").classList.add("animate__animated","animate__backInUp"),document.getElementById("pageContainer").classList.add("animate__animated","animate__backInUp"),setTimeout((()=>{setupTranlsation()}),1100),document.documentElement.addEventListener("keydown",(e=>{!function shiftShortcut(e){if(s)return;function switchItem(e){e?(document.querySelector("[data-action=erase]").classList.remove("clickImg"),document.querySelector("[data-action=pen]").classList.add("clickImg")):(document.querySelector("[data-action=erase]").classList.add("clickImg"),document.querySelector("[data-action=pen]").classList.remove("clickImg"))}switch(e.key){case"Shift":p?(v.specific.shouldDraw=!1,v.zIndex++,document.querySelector("[data-action=pen]").classList.remove("clickImg")):switchItem(!0),"cursorerase"===d[1]&&(d=[!1,"cursorpointer"]),p=!p,r=!1,canvasPen();break;case"Alt":v.specific.shouldDraw=!1,v.zIndex++,p=!1,r=!1;break;case"Backspace":r=!r,r?(d=[!0,"cursorerase"],switchItem(!1)):(d=[!0,"cursorpointer"],document.querySelector("[data-action=erase]").classList.remove("clickImg"))}let t=[["+","-","ArrowLeft","ArrowRight"],[document.querySelector("[data-action=zoomin]"),document.querySelector("[data-action=zoomout]"),document.querySelector("[data-action=prev]"),document.querySelector("[data-action=next]")]];for(let n=0;n<t[0].length;n++)e.key===t[0][n]&&t[1][n].click()}(e)}));for(let e of["mouseup","mouseleave","touchstart","touchend"])document.documentElement.addEventListener(e,(()=>{L.currentlyErasing=!1}));i.element=pdfjsLib.getDocument(e),i.element.promise.then((e=>{i.promise=e,canvasPDF(i.page)}))}),1e3)}let m=90;function getProportion(e,t,n,o){return o?t*n/e:e*n/t}let u,g=!0;function greatViewport(e){let t=1,n=m;return e.width/e.height>1.2&&(n-=10*(e.width/e.height-1)*6),e.width/e.height<.6&&(n+=10*(1.1-e.width/e.height)*6),t=e.width>e.height?getProportion(e.width,e.height,o[2][0]*n/100,!0)/e.width:getProportion(e.width,e.height,o[2][1]*n/100,!1)/e.height,t}function setUpCanvas(e,t,n){let o=window.devicePixelRatio||1;if(e.width=Math.floor(t.width*o),e.height=Math.floor(t.height*o),e.style.width=Math.floor(t.width)+"px",e.style.height=Math.floor(t.height)+"px",n)return e}function canvasPDF(e){g?(g=!1,i.promise.getPage(e).then((function(e){let t=window.devicePixelRatio||1,n=e.getViewport({scale:1}),o=greatViewport(n);n=e.getViewport({scale:o}),setUpCanvas(document.getElementById("displayCanvas"),n,!1);let a=document.getElementById("displayCanvas");o*=3,n=e.getViewport({scale:o}),u=setUpCanvas(document.createElement("canvas"),n,!0);let l={canvasContext:u.getContext("2d"),transform:1!==t?[t,0,0,t,0,0]:null,viewport:n};e.render(l).promise.then((()=>{if(g=!0,a.getContext("2d").drawImage(u,0,0,a.width,a.height),I.changeItems.keepZoomSize?setFixedWidth(!0):B=[document.getElementById("displayCanvas").style.width,document.getElementById("displayCanvas").style.height,document.getElementById("displayCanvas").height,document.getElementById("displayCanvas").width],x){let e=10*window.innerWidth/100+document.getElementById("containerOfOptions").offsetWidth;document.getElementById("containerOfOptions").classList.add("fullcontainer"),document.getElementById("pdfcontainer").style=`display: flex; float: left; width: ${window.innerWidth-e-2}px`}}))}),(e=>{g=!0,i.page--,console.warn(e)}))):setTimeout((()=>{canvasPDF(e)}),1500)}let p=!1,y={shiftAlert:"You can also press Shift to draw into the PDF. Press it again to stop drawing.",dropdownClose:"Close this drowdown menu to apply the new color. You can also add new colors form Settings.",seconds:"Seconds",nameColor:"How do you want to name this color?",maxZoom:"is the maxinum zoom level permitted",minZoom:"is the mininum zoom level permitted",noShowAgain:"Don't show again",zoomCanvas:"Zooming in PDFs and keeping annotations is experimental, and it might (and most probalby will) cause glitches.",webKitColor:'Select the color from the input below, and then click on the "Save custom color" button to choose a name for it.',exportInformation:"You can export the PDF page (even with annotations) as an image",save:"Save as image",qualityInfo:"Choose the image quality",customExport:"Export the following pages",customItalic:"Use '1-5' for downloading from 1 to 5 or '1,5' for downloading page 1 and 5. Leave blank for downloading only the current page.",resize:"Resize the image width and height",resizeItalic:"The aspect ratio will remain the same.",saveZip:"Save as a .zip file",hoverTranslation:{prev:"Show previous page",contract:"Decrease canvas size",zoomout:"Decrease zoom",pen:"Create drawing",timer:"Change timer to delete drawing",erase:"Delete annotazione",color:"Change drawing color",fullscreen:"Full screen mode",normalscreen:"Exit from full screen mode",downloadAsImg:"Export PDF as an image",settings:"Settings",zoomin:"Increase zoom",expand:"Increase canvas size",next:"Show next page"}};function canvasPen(){if(!document.querySelector("[data-action=pen]").classList.contains("clickImg")&&!p)return;if(p||topAlert(y.shiftAlert,"shiftAlert"),v.specific.shouldDraw)return v.specific.shouldDraw=!1,void v.zIndex++;let e=document.createElement("div");e.width=document.getElementById("displayCanvas").offsetWidth,e.height=document.getElementById("displayCanvas").offsetHeight,e.style=`position: absolute; z-index: ${v.zIndex}; margin-top: 15px; margin-bottom: 15px; border-radius: 8px;`,e.classList.add("displayCanvas","opacityRemove"),e.setAttribute("topstatus","0"),e.setAttribute("leftstatus","0"),e.setAttribute("data-zoom",L.zoomLevel),e.setAttribute("data-page",`${i.page}`);let t=new C2S(document.getElementById("displayCanvas").offsetWidth,document.getElementById("displayCanvas").offsetHeight);t.strokeStyle=`rgb(${I.availableHighlightColors.currentColor})`,t.lineWidth=5,v.specific.canvasElement=t,v.specific.shouldDraw=!0,v.specific.newCanvas=e,addEvents(e),setTimeout((()=>{e.style.opacity="0",setTimeout((()=>{e.remove()}),500)}),1e3*I.changeItems.timer),document.querySelector(".pageBackground").append(e)}let h=!1,f=!1;function canvasDrawCheck(){f&&(canvasPen(),document.querySelector("[data-action=erase]").classList.contains("clickImg")&&(h=!1),f=!1)}for(let e of["mouseup","touchend","touchcancel"])document.addEventListener(e,(()=>{canvasDrawCheck()}));function addEvents(e){function mouseover(t){!function canvasMove(e){if(!v.specific.shouldDraw)return;let t=[e.offsetX,e.offsetY],n=0;if(-1!==navigator.userAgent.toLowerCase().indexOf("safari")&&-1===navigator.userAgent.toLowerCase().indexOf("chrome")&&(n=32),null!==v.specific.previousItem[0])try{v.specific.canvasElement.lineTo(t[0],t[1]+n),v.specific.canvasElement.stroke()}catch(e){console.warn(e),canvasPen(),canvasPen()}else v.specific.canvasElement.beginPath(),v.specific.canvasElement.moveTo(t[0],t[1]+n);v.specific.previousItem=t,v.specific.newCanvas.innerHTML=v.specific.canvasElement.getSerializedSvg()}(t),canvasEraser(t),d[0]&&(d[0]=!1,cursorChange(e,d[1])),"cursorerase"===d[1]&&canvasEraser(t,!0)}for(let t of["mousedown","touchstart"])e.addEventListener(t,(()=>{canvasPen(),f=!0,document.querySelector("[data-action=erase]").classList.contains("clickImg")&&(h=!0)}));e.addEventListener("mousemove",(e=>{mouseover(e)})),e.addEventListener("touchmove",(t=>{t.preventDefault(),mouseover({offsetX:t.touches[0].pageX-e.getBoundingClientRect().left-window.scrollX-e.scrollLeft,offsetY:t.touches[0].pageY-e.getBoundingClientRect().top-window.scrollY-e.scrollTop,clientX:t.touches[0].pageX,clientY:t.touches[0].pageY})}));for(let t of["mouseleave","touchend"])e.addEventListener(t,(()=>{v.specific.previousItem[0]=null,e.style.cursor="pointer"}));e.addEventListener("hover",(()=>{intelligentCursor(e)})),e.addEventListener("mousedown",(e=>{document.querySelector("[data-action=erase]").classList.contains("clickImg")||(L.currentlyErasing=!0),k=[e.screenX,e.screenY]})),e.addEventListener("touchstart",(e=>{e.preventDefault();var t=e.touches[0];document.querySelector("[data-action=erase]").classList.contains("clickImg")||(L.currentlyErasing=!0),k=[t.pageX,t.pageY]})),e.addEventListener("mouseenter",(()=>{cursorChange(e)}))}function cursorChange(e,t){let n=t;void 0===n&&(n="cursorpointer",document.querySelector("[data-action=pen]").classList.contains("clickImg")?n="cursorpen":document.querySelector("[data-action=erase]").classList.contains("clickImg")&&(n="cursorerase")),getImg([e],n,!0)}function canvasEraser(e,t){if(!(!0===t||document.querySelector("[data-action=erase]").classList.contains("clickImg")&&h))return;let n=document.getElementById("displayCanvas").getBoundingClientRect(),o=(e.clientX,n.left,e.clientY,n.top,document.querySelectorAll("g"));for(let a of o){let l=a.getBoundingClientRect();function deleteCanvas(){null===a.parentElement.parentElement.getAttribute("data-delete")&&(a.parentElement.parentElement.setAttribute("data-delete","1"),a.parentElement.parentElement.style.opacity=0,setTimeout((()=>{a.parentElement.parentElement.remove()}),700))}"yes"!==a.getAttribute("pdf")&&(l.bottom-e.clientY>-20&&l.bottom-e.clientY<20&&deleteCanvas(),l.left-e.clientX>-20&&l.left-e.clientX<20&&deleteCanvas())}}function hexToRgbNew(e){var t=new ArrayBuffer(4);new DataView(t).setUint32(0,parseInt(e,16),!1);var n=new Uint8Array(t);return n[1]+","+n[2]+","+n[3]}let v={zIndex:1,specific:{canvasElement:null,shouldDraw:!1,previousItem:[null,null],newCanvas:null}},E={availableHighlightColors:{Red:[255,0,0,255],Blue:[0,0,255,255],Green:[0,255,0,255],currentColor:[255,0,0,255]},customColors:{},dropdownSelectedOptions:{timer:2,color:1},showAlert:{timer:!1,color:!1,downloadImg:!1},changeItems:{timer:15,showTips:!0,alertInt:5e3,pointerColorEnabled:!1,pointerColorColor:"#ffffff",keepZoomSize:null,moveZoom:!0,resizeCanvas:!1},themes:[{name:"Umber Brown",colorProperties:{text:"#fcf7f2",optionbackground:"#745741",background:"#261508",accent:"#b56726",settingsoverlay:"#322317",card:"#5c3c22",optionitem:"#43352a",safetext:"#fcf7f2",optioncolor:"#403021"},customItemRefer:"a"},{name:"Slate Gray",colorProperties:{text:"#171717",optionbackground:"#d4d4d4",background:"#ebebeb",accent:"#212121",settingsoverlay:"#c1c1c1",card:"#afafaf",optionitem:"#afafaf",safetext:"#ebebeb",optioncolor:"#a3a3a3"},customItemRefer:"b"},{name:"Pearl White",colorProperties:{text:"#171717",optionbackground:"#8b9692",background:"#fcfcfd",accent:"#505a57",settingsoverlay:"#d4d4d4",card:"#d3d3d3",optionitem:"#cedad6",safetext:"#ebebeb",optioncolor:"#abb6b2"},customItemRefer:"c"},{name:"Dracula Dark",colorProperties:{text:"#fcf7f2",optionbackground:"#44475A",background:"#282a36",accent:"#c0c2d9",settingsoverlay:"#44475A",card:"#787b90",optionitem:"#787b90",safetext:"#fcf7f2",optioncolor:"#787b90"},customItemRefer:"d"},{name:"Standard Dark",colorProperties:{text:"#fcf7f2",optionbackground:"#6b6b6b",background:"#191919",accent:"#925c5f",settingsoverlay:"#393939",card:"#6b6b6b",optionitem:"#aaaaaa",safetext:"#fcf7f2",optioncolor:"#575757"},customItemRefer:"e"}],export:{processPage:[],pageId:0}};null!==localStorage.getItem("PDFPointer-customColors")&&"{}"!==localStorage.getItem("PDFPointer-customColors")&&(E.availableHighlightColors=JSON.parse(localStorage.getItem("PDFPointer-customColors")));let I=ObservableSlim.create(E,!0,(function(e){let t=e[0];if("update"===t.type){let e=t.currentPath.split(".");if(-1===b.position.indexOf(t.currentPath))return;let n=E;for(let t=0;t<e.length-1;t++)n=n[e[t]];localStorage.setItem(b.localProperty[b.position.indexOf(t.currentPath)],t.newValue)}}));function usefulDropdownGenerator(e,t,n){if(I.showAlert[e])return;let o=createDropdown(document.querySelector(`[data-action=${e}]`),void 0,e);for(let n of t){let a=addDropdownNameItem(n,o.childNodes.length);a.addEventListener("click",(()=>{I.changeItems[e]=parseInt(n.substring(0,n.indexOf(" "))),I.dropdownSelectedOptions[e]=t.indexOf(n)+1})),o.appendChild(a),hoverItem(a)}let a=function addDropdownTextbox(e,t){let n=document.createElement("div");n.classList.add("dropdownItem");let o=document.createElement("input");o.type=t,"number"===t&&(o.min=1);return o.placeholder=e,n.appendChild(o),n}("Custom input",n);hoverItem(a),a.addEventListener("click",(()=>{I.dropdownSelectedOptions[e]=o.childNodes.length-1})),a.addEventListener("input",(t=>{I.changeItems[e]=`${t.target.value}`})),o.appendChild(a),a.value=`${I.changeItems[e]}`,document.body.appendChild(o);for(let t=0;t<o.childNodes.length;t++)I.dropdownSelectedOptions[e]===t?o.childNodes[t].style="border-left: solid 2px var(--accent);":o.childNodes[t].style="padding-left: 22px";"color"===n&&topAlert(y.dropdownClose,"dropClose")}function createDropdown(e,t,n){s=!0,I.showAlert[n]=!0;let o=document.createElement("div");o.classList.add("animate__animated","animate__backInDown");let a=document.createElement("img");a.width=25,a.height=25,a.setAttribute("data-customanimate","1"),getImg([a],t?"fullscreenoff":"save"),hoverItem(a),a.addEventListener("click",(()=>{if(s=!1,o.classList.add("animate__backOutUp"),setTimeout((()=>{o.remove()}),1e3),"color"===o.childNodes[o.childNodes.length-1].childNodes[0].type){let e=hexToRgbNew(o.childNodes[o.childNodes.length-1].childNodes[0].value.replace("#","")).split(",");I.availableHighlightColors.currentColor=[parseInt(e[0]),parseInt(e[1]),parseInt(e[2]),255]}I.showAlert[n]=!1})),a.classList.add("closeBtn","saveDropdown"),o.append(a);var l=e.getBoundingClientRect();o.classList.add("dropdown");let i=25;screen.availHeight>screen.availWidth&&(i=60,o.classList.add("verticalDropdown"));let r=`top: ${parseInt(l.top)+75+window.scrollY}px; `;return l.left+25+i*document.body.offsetWidth/100<document.body.offsetWidth?r+=`left: ${l.left+25}px; `:r+=`right: ${l.right-25-i*document.body.offsetWidth/100}px; `,r=r.replace("right: -","left: ").replace("left: -","right: "),o.style=r,o}function addDropdownNameItem(e,t){"currentColor"===e&&(e="");let n=document.createElement("div");n.classList.add("dropdownItem"),n.addEventListener("click",(()=>{n.parentElement.childNodes[0].click(),"color"===n.parentElement.childNodes[n.parentElement.childNodes.length-1].childNodes[0].type&&(I.availableHighlightColors.currentColor=I.availableHighlightColors[e])}));let o=document.createElement("l");return o.textContent=e,o.classList.add("dropdownLabel"),n.appendChild(o),n}function topAlert(e,t,n){if(!I.changeItems.showTips||null!==localStorage.getItem("PDFPointer-notshow")&&-1!==localStorage.getItem("PDFPointer-notshow").split(",").indexOf(t))return;let o=document.createElement("div");o.classList.add("vertcenter","opacityRemove"),o.style="width: 100vw; z-index: 9999998";let a=document.createElement("div");function deleteFunction(){o.style.opacity="0",setTimeout((()=>{o.remove()}),500)}a.classList.add("alert","vertcenter"),setTimeout((()=>{deleteFunction()}),E.changeItems.alertInt);let l=document.createElement("img");getImg([l],"alert"),l.style.width="25px",l.style.height="25px";let i=document.createElement("l");if(i.style.marginLeft="10px",i.textContent=e,a.append(l,i),n){let e=document.createElement("a");e.href="./index.html?nolang",e.textContent="Go back to English",e.style.marginLeft="5px",a.append(e)}let r=document.createElement("l");r.classList.add("noshow","link"),r.style.marginLeft="10px",r.textContent=y.noShowAgain,r.addEventListener("click",(()=>{null===localStorage.getItem("PDFPointer-notshow")&&localStorage.setItem("PDFPointer-notshow",""),localStorage.setItem("PDFPointer-notshow",`${localStorage.getItem("PDFPointer-notshow")}${t},`),deleteFunction()})),a.append(document.createElement("br"),document.createElement("br"),r),o.append(a),document.body.append(o),o.style.opacity="0",setTimeout((()=>{o.style.opacity="1"}),350)}function showRightCanvas(){for(let e of document.querySelectorAll("[data-page]"))e.getAttribute("data-page")===`${i.page}`?e.style.display="inline":e.style.display="none"}function fixZoom(){for(let e of document.querySelectorAll("g"))item=e.parentElement,item.parentElement.style.transformOrigin="top left",item.parentElement.style.transform=`scale(${1/parseInt(item.parentElement.getAttribute("data-zoom"))})`,item.parentElement.height=B[2],item.parentElement.width=B[3],item.parentElement.style.marginTop="0px",item.parentElement.style.marginLeft="0px",parseInt(item.parentElement.getAttribute("data-page"))===i.page&&I.changeItems.moveZoom||parseInt(item.parentElement.getAttribute("data-page"))===i.page&&!I.changeItems.moveZoom&&1===parseInt(item.parentElement.getAttribute("data-zoom"))?item.parentElement.style.display="inline":item.parentElement.style.display="none";L.zoomLevel=1,L.x=0,L.y=0,I.changeItems.keepZoomSize&&(setFixedWidth(),resizeCanvasSameSize())}function bounceTextEvents(e,t){t.addEventListener("mouseenter",(()=>{e.classList.add("animate__animated","animate__headShake"),setTimeout((()=>{e.classList.remove("animate__animated","animate__headShake")}),800)}))}addEvents(document.getElementById("displayCanvas")),document.querySelector("[data-action=timer]").addEventListener("click",(()=>{usefulDropdownGenerator("timer",[`5 ${y.seconds}`,`15 ${y.seconds}`,`30 ${y.seconds}`,`60 ${y.seconds}`],"number")})),document.querySelector("[data-action=color]").addEventListener("click",(()=>{usefulDropdownGenerator("color",Object.keys(I.availableHighlightColors),"color")})),document.querySelector("[data-action=next]").addEventListener("click",(()=>{i.page++,showRightCanvas(),canvasPDF(i.page),fixZoom()})),document.querySelector("[data-action=prev]").addEventListener("click",(()=>{1!==i.page&&(i.page--,showRightCanvas(),canvasPDF(i.page),fixZoom())}));let w=0;function fetchColors(e){for(let t=0;t<Object.keys(e).length;t++){if("currentColor"===Object.keys(e)[t])continue;w+=57,document.getElementById("optionContainer").style.maxHeight=`${w}px`;let n=document.createElement("div");n.classList.add("colorContainer");let o=document.createElement("l");o.textContent=Object.keys(e)[t],o.style="display: flex; float: left",bounceTextEvents(o,n);let a=e[Object.keys(e)[t]],l=createContainerInfo("bin",`rgb(${a[0]},${a[1]},${a[2]})`,void 0,n);l.addEventListener("click",(()=>{delete e[Object.keys(e)[t]],document.documentElement.style.setProperty("--deleteitem",`rgb(${a[0]},${a[1]},${a[2]})`),storeCustomOptions([e],["PDFPointer-customColors"]),n.classList.add("runAnimation"),setTimeout((()=>{n.style.backgroundColor=`rgb(${a[0]},${a[1]},${a[2]})`,n.classList.add("animate__animated","animate__backOutDown"),setTimeout((()=>{n.classList.add("deleteAnimation"),w-=57,document.getElementById("optionContainer").style.maxHeight=`${w}px`,setTimeout((()=>{n.remove()}),250)}),1e3)}),1e3)})),n.append(o,l,document.createElement("br")),document.getElementById("optionContainer").append(n)}}function updateColorNew(){let e=prompt(`${y.nameColor} [${document.getElementById("colorNew").value}]`);if(null!==e){let t=hexToRgbNew(document.getElementById("colorNew").value.replace("#","")).split(",");t.push(255),I.availableHighlightColors[e]=t,storeCustomOptions([I.availableHighlightColors],["PDFPointer-customColors"]);let n={};n[e]=t,fetchColors(n)}}function getImg(e,n,o,a){if(t.toload)return void setTimeout((()=>{getImg(e,n,o,a)}),100);let l=[getComputedStyle(document.body).getPropertyValue("--accent"),getComputedStyle(document.body).getPropertyValue("--text")];for(let i of e){let e=void 0===n?i.getAttribute("fetchlink"):n,r=t[e];void 0!==a&&(l[0]=a);let c=URL.createObjectURL(new Blob([r.replaceAll("#c5603f",l[0]).replaceAll("#fcf7f2",l[1])],{type:"image/svg+xml"}));if(o){let e=hexToRgbNew(l[0].replace("#","")).split(",");I.changeItems.pointerColorEnabled&&(e=hexToRgbNew(I.changeItems.pointerColorColor.replace("#","")).split(",")),i.style.cursor=`url("data:image/svg+xml;utf8,${r.replaceAll("fill='#c5603f'",`fill='rgb(${e[0]},${e[1]},${e[2]})'`)}") 0 32, auto`}else i.src=c}}function createContainerInfo(e,t,n,o){let a=document.createElement("div");a.classList.add("closeBtn","colorShow"),a.style=`display: flex; float: right; background-color: ${t}; margin-left: 10px`;let l=document.createElement("img");l.style.width="20px",l.style.height="20px",l.classList.add("vertcenter"),l.addEventListener("mouseenter",(()=>{l.classList.add("rotateAnimation")})),l.addEventListener("mouseleave",(()=>{l.classList.remove("rotateAnimation")})),getImg([l],e,void 0,n);let i=document.createElement("div");return i.classList.add("vertcenter"),i.style="width: 100%; height: 100%",i.append(l),a.append(i),o.addEventListener("mouseenter",(()=>{l.classList.add("containerPhotoAdd")})),o.addEventListener("mouseleave",(()=>{l.classList.add("containerPhotoRemove"),setTimeout((()=>{l.classList.remove("containerPhotoRemove","containerPhotoAdd")}),300)})),a}document.getElementById("optionContainer").innerHTML="",fetchColors(I.availableHighlightColors),-1!==navigator.userAgent.toLowerCase().indexOf("chrome")?document.getElementById("colorNew").addEventListener("focusout",(()=>{updateColorNew()})):(document.getElementById("colorSaveBtn").style.display="flex",document.querySelector("[data-translate=customColorDescription]").textContent=y.webKitColor,document.getElementById("colorSaveBtn").addEventListener("click",(()=>{updateColorNew()}))),getImg(document.querySelectorAll("[fetchlink]")),function fetchThemes(){null==localStorage.getItem("PDFPointer-customThemeJson")&&localStorage.setItem("PDFPointer-customThemeJson",JSON.stringify({items:{}}));try{let e=JSON.parse(localStorage.getItem("PDFPointer-customThemeJson")).items;for(let t=0;t<Object.keys(e).length;t++)e[t].trackCustom=t,I.themes.push(e[t])}catch(e){console.warn(e)}for(let e of I.themes){let t=document.createElement("div");t.classList.add("colorContainer","containerItemsAnimation");let n=document.createElement("l");n.style="display: flex; float: left",n.innerHTML=e.name,bounceTextEvents(n,t);let o=[createContainerInfo("colorbucket",e.colorProperties.background,e.colorProperties.accent,t)];o[0].addEventListener("click",(()=>{for(let t in e.colorProperties)document.documentElement.style.setProperty(`--${t}`,`${e.colorProperties[t]}`);getImg(document.querySelectorAll("[fetchlink]")),localStorage.setItem("PDFPointer-selectedtheme",e.customItemRefer),safariFixSelect()})),o[0].setAttribute("data-themerefer",e.customItemRefer),o[1]=createContainerInfo("export",e.colorProperties.background,e.colorProperties.accent,t),o[1].addEventListener("click",(()=>{let t=document.createElement("a");t.href=URL.createObjectURL(new Blob([JSON.stringify(e)],{type:"text/plain"})),t.download=`${e.name}-export.json`,t.click()})),e.isCustom&&(o[2]=createContainerInfo("bin",e.colorProperties.background,e.colorProperties.accent,t),o[2].addEventListener("click",(()=>{document.documentElement.style.setProperty("--deleteitem",e.colorProperties.optionitem),t.classList.add("runAnimation");let n=JSON.parse(localStorage.getItem("PDFPointer-customThemeJson")).items,o=[];for(let t=0;t<Object.keys(n).length;t++)t!==e.trackCustom&&o.push(n[t]);localStorage.setItem("PDFPointer-customThemeJson",JSON.stringify({items:o})),setTimeout((()=>{document.getElementById("themeOptionShow").style.maxHeight=parseInt(document.getElementById("themeOptionShow").style.maxHeight.substring(0,document.getElementById("themeOptionShow").style.maxHeight.indexOf("px")))-57+"px",t.style.backgroundColor=`${e.accent}`,t.classList.add("animate__animated","animate__backOutDown"),setTimeout((()=>{t.remove()}),1e3)}),1e3)}))),t.append(n,...o,document.createElement("br")),document.getElementById("themeOptionShow").append(t)}}();function dialogGeneralAnimation(e,t){t?(document.getElementById(e).style.display="inline",document.getElementById(e).classList.add("animate__animated","animate__backInDown"),setTimeout((()=>{document.getElementById(e).classList.remove("animate__animated","animate__backInDown")}),1100)):(document.getElementById(e).classList.add("animate__animated","animate__backOutDown"),setTimeout((()=>{document.getElementById(e).style.display="none",document.getElementById(e).classList.remove("animate__animated","animate__backOutDown")}),1100))}document.querySelector("[data-action=settings]").addEventListener("click",(()=>{dialogGeneralAnimation("settings",!0),s=!0;for(let e=0;e<A.length;e++)A[e][2].setAttribute("defaultHeight",`${A[e][2].offsetHeight}px`),A[e][3]&&(A[e][0].style.display="inline",A[e][0].style.opacity="1");document.getElementById("themeOptionShow").style.maxHeight=`${document.getElementById("themeOptionShow").offsetHeight}px`})),document.getElementById("closeSettings").addEventListener("click",(()=>{s=!1,dialogGeneralAnimation("settings",!1)})),document.getElementById("fileOpen").onchange=function(){if(document.getElementById("fileOpen").files){let e=new FileReader;e.onload=()=>{startPDFRead(e.result)},c=document.getElementById("fileOpen").files[0].name,e.readAsDataURL(document.getElementById("fileOpen").files[0])}},document.getElementById("openPicker").addEventListener("click",(()=>{document.getElementById("fileOpen").click()}));let b={localProperty:["PDFPointer-currentcolor","PDFPointer-timerselected","PDFPointer-colorselected","PDFPointer-timerlength","PDFPointer-showtips","PDFPointer-alertdurationn","PDFPointer-customPointerEnable","PDFPointer-customPointerColor","PDFPointer-zoomType","PDFPointer-movezoom","PDFPointer-resizecanvas"],position:["availableHighlightColors.currentColor","dropdownSelectedOptions.timer","dropdownSelectedOptions.color","changeItems.timer","changeItems.showTips","changeItems.alertInt","changeItems.pointerColorEnabled","changeItems.pointerColorColor","changeItems.keepZoomSize","changeItems.moveZoom","changeItems.resizeCanvas"],type:["array","int","int","int","bool","int","bool","string","bool","bool","bool"]};for(let e=0;e<b.localProperty.length;e++)if(null!==localStorage.getItem(b.localProperty[e])){let t=E,n=b.position[e].split(".");for(let e=0;e<n.length-1;e++)t=t[n[e]];switch(b.type[e]){case"array":t[n[n.length-1]]=localStorage.getItem(b.localProperty[e]).split(",");break;case"int":t[n[n.length-1]]=parseInt(localStorage.getItem(b.localProperty[e]));break;case"bool":t[n[n.length-1]]="true"===localStorage.getItem(b.localProperty[e]);break;case"string":t[n[n.length-1]]=localStorage.getItem(b.localProperty[e])}}let C={checkbox:[document.getElementById("alertCheck"),document.getElementById("pointerCheck"),document.getElementById("moveZoomCheck"),document.getElementById("resizeCanvasCheck")],changeVal:["changeItems.showTips","changeItems.pointerColorEnabled","changeItems.moveZoom","changeItems.resizeCanvas"]};for(let e=0;e<C.checkbox.length;e++){let t=E,n=C.changeVal[e].split(".");for(let e=0;e<n.length-1;e++)t=t[n[e]];C.checkbox[e].checked=t[n[n.length-1]]}let x=!1;function intelligentCursor(e){document.querySelector("[data-action=pen]").classList.contains("clickImg")?getImg([e],"pen-fill",!0):document.querySelector("[data-action=erase]").classList.contains("clickImg")?getImg([e],"erase-fill",!0):getImg([e],"pointer",!0)}document.getElementById("pageContainer").style.margin="0px auto",document.querySelector("[data-action=fullscreen]").addEventListener("click",(()=>{document.documentElement.requestFullscreen()})),document.querySelector("[data-action=normalscreen]").addEventListener("click",(()=>{document.exitFullscreen()})),document.querySelector("[data-action=erase]").addEventListener("click",(()=>{L.currentlyErasing=!1})),document.getElementById("displayCanvas").addEventListener("hover",intelligentCursor(document.getElementById("displayCanvas"))),document.addEventListener("fullscreenchange",(e=>{if(canvasDrawCheck(),document.fullscreenElement){x=!0;let e=10*window.innerWidth/100+document.getElementById("containerOfOptions").offsetWidth;document.getElementById("toolMain").classList.remove("vertcenter"),document.getElementById("containerOfOptions").classList.add("fullcontainer"),document.getElementById("pdfcontainer").style=`display: flex; float: left; width: ${window.innerWidth-e-2}px`,document.querySelector("[data-action=fullscreen]").style.display="none",o[1]=[document.documentElement.clientWidth,document.documentElement.clientHeight],o[2]=[document.documentElement.clientWidth,document.documentElement.clientHeight],document.getElementById("containerOfOptions").style.marginTop="30px",document.getElementById("containerOfOptions").style.marginBottom="30px",document.querySelector("[data-action=normalscreen]").style.display="inline";for(let e of document.querySelectorAll("[data-moveleft]"))e.style=`margin-bottom: ${e.getAttribute("data-moveleft")}`;for(let e of document.querySelectorAll("[data-moveright]"))e.style=`margin-top: ${e.getAttribute("data-moveright")}`;L.zoomLevel<3?document.querySelector("[data-action=zoomin]").click():document.querySelector("[data-action=zoomout]").click(),setupTranlsation()}else{x=!1,document.getElementById("toolMain").classList.add("vertcenter"),document.getElementById("containerOfOptions").classList.remove("fullcontainer"),document.getElementById("pdfcontainer").style="",document.getElementById("pdfcontainer").classList.add("vertcenter"),document.querySelector("[data-action=normalscreen]").style.display="none",document.querySelector("[data-action=fullscreen]").style.display="inline",document.getElementById("containerOfOptions").style.marginTop="0px",document.getElementById("containerOfOptions").style.marginBottom="0px",document.getElementById("pageContainer").style.marginLeft="",document.getElementById("pageContainer").style.margin="0 auto",o[2]=o[0];for(let e of document.querySelectorAll("[data-moveleft]"))e.style=`margin-right: ${e.getAttribute("data-moveleft")}`;for(let e of document.querySelectorAll("[data-moveright]"))e.style=`margin-left: ${e.getAttribute("data-moveright")}`;setupTranlsation()}}));let L={zoomLevel:1,x:0,y:0,currentlyErasing:!1},k=null,B=0;function canvasGeneralResize(){0===B&&(B=[document.getElementById("displayCanvas").style.width,document.getElementById("displayCanvas").style.height,document.getElementById("displayCanvas").height,document.getElementById("displayCanvas").width]);document.getElementById("displayCanvas").height,document.getElementById("displayCanvas").width;document.getElementById("displayCanvas").style.width=B[0].replace("px","")*L.zoomLevel+"px",document.getElementById("displayCanvas").style.height=parseInt(B[1].replace("px",""))*L.zoomLevel+"px",document.getElementById("displayCanvas").height=B[2]*L.zoomLevel,document.getElementById("displayCanvas").width=B[3]*L.zoomLevel,document.getElementById("displayCanvas").getContext("2d").drawImage(u,0,0,document.getElementById("displayCanvas").width,document.getElementById("displayCanvas").height),document.body.offsetWidth<parseInt(document.getElementById("displayCanvas").style.width.replace("px",""))?document.getElementById("canvasMargin").style.marginLeft=parseInt(document.getElementById("displayCanvas").style.width.replace("px",""))-document.body.offsetWidth+"px":document.getElementById("canvasMargin").style.marginLeft="0px";for(let e of document.querySelectorAll("g"))if(I.changeItems.moveZoom){if(item=e.parentElement,"none"===item.parentElement.style.display)continue;let t=parseFloat(item.parentElement.getAttribute("data-zoom"));item.parentElement.style.transformOrigin="top left",item.parentElement.style.transform=`scale(${L.zoomLevel/t})`}else parseFloat(e.parentElement.parentElement.getAttribute("data-zoom"))===L.zoomLevel?e.parentElement.parentElement.style.display="inline":e.parentElement.parentElement.style.display="none"}function closeCanvasDialog(){dialogGeneralAnimation("zoomChooseContainer",!1)}document.querySelector("[data-action=zoomin]").addEventListener("click",(()=>{if(null===localStorage.getItem("PDFPointer-zoomType")&&(I.changeItems.keepZoomSize=!1),L.zoomLevel+=.5,L.zoomLevel>3)return topAlert(`300% ${y.maxZoom}`,"maxZoom"),void(L.zoomLevel=3);I.changeItems.keepZoomSize?(setFixedWidth(),resizeCanvasSameSize()):(x&&(document.getElementById("pageContainer").style.marginLeft=`${document.getElementById("containerOfOptions").getBoundingClientRect().right+40}px`),canvasGeneralResize())})),document.getElementById("chooseFirst").addEventListener("click",(()=>{I.changeItems.keepZoomSize=!0,closeCanvasDialog()})),document.getElementById("chooseSecond").addEventListener("click",(()=>{I.changeItems.keepZoomSize=!1,closeCanvasDialog()})),document.querySelector("[data-action=zoomout]").addEventListener("click",(()=>{if(null===localStorage.getItem("PDFPointer-zoomType")&&(I.changeItems.keepZoomSize=!1),L.zoomLevel-=.5,L.zoomLevel<.5)return topAlert(`50% ${y.minZoom}`,"minZoom"),void(L.zoomLevel=.5);I.changeItems.keepZoomSize?(setFixedWidth(),resizeCanvasSameSize()):(x&&(document.getElementById("pageContainer").style.marginLeft=`${document.getElementById("containerOfOptions").getBoundingClientRect().right+40}px`),canvasGeneralResize()),L.x=0,L.y=0}));let S=[];function resizeCanvasSameSize(){document.getElementById("displayCanvas").style.width=`${parseInt(S[0].replace("px","")*L.zoomLevel)}px`,document.getElementById("displayCanvas").style.height=`${parseInt(S[1].replace("px","")*L.zoomLevel)}px`,document.getElementById("displayCanvas").style.minHeight=document.getElementById("displayCanvas").style.height,document.getElementById("displayCanvas").width=S[2]*L.zoomLevel,document.getElementById("displayCanvas").height=S[3]*L.zoomLevel,document.getElementById("displayCanvas").getContext("2d").drawImage(u,0,0,document.getElementById("displayCanvas").width,document.getElementById("displayCanvas").height);for(let e of document.querySelectorAll("g"))I.changeItems.moveZoom?(e.parentElement.parentElement.style.transformOrigin="top left",e.parentElement.parentElement.style.transform=`scale(${L.zoomLevel/parseInt(e.parentElement.parentElement.getAttribute("data-zoom"))})`):parseFloat(e.parentElement.parentElement.getAttribute("data-zoom"))===L.zoomLevel?e.parentElement.parentElement.style.display="inline":e.parentElement.parentElement.style.display="none"}function setFixedWidth(e){(""===document.getElementById("canvasContainer").style.width||e)&&(document.getElementById("canvasContainer").style=`overflow: auto; width: ${document.getElementById("displayCanvas").style.width}; height: ${document.getElementById("displayCanvas").style.height}; position: relative`,S=[document.getElementById("displayCanvas").style.width,document.getElementById("displayCanvas").style.height,document.getElementById("displayCanvas").width,document.getElementById("displayCanvas").height])}function storeCustomOptions(e,t){for(let n=0;n<t.length;n++)localStorage.setItem(t[n],JSON.stringify(e[n]))}let P,D={};fetch("./translationItems/licenses.json").then((e=>{e.json().then((e=>{D=e}))}));for(let e of document.querySelectorAll("[data-license]"))e.addEventListener("click",(()=>{document.getElementById("licenseAnimatiom").classList.add("animate__animated","animate__shakeX"),e.classList.add("animate__animated","animate__shakeX"),document.getElementById("licenseText").innerHTML=D[e.getAttribute("data-license")].replace("{DateAndAuthorReplace}",e.getAttribute("data-author")).replaceAll("\n","<br>"),setTimeout((()=>{e.classList.remove("animate__animated","animate__shakeX"),document.getElementById("licenseAnimatiom").classList.remove("animate__animated","animate__shakeX")}),1e3)}));document.getElementById("appversion").textContent=n,document.getElementById("openDiv").addEventListener("drop",(e=>{!function dropFile(e){function readFileStart(e){let t=new FileReader;t.onload=function(){startPDFRead(t.result)},c=e.name,t.readAsDataURL(e)}e.preventDefault(),e.dataTransfer.items?"file"===e.dataTransfer.items[0].kind&&readFileStart(e.dataTransfer.items[0].getAsFile()):readFileStart(e.dataTransfer.files[0])}(e)})),document.getElementById("openDiv").addEventListener("dragover",(e=>{e.preventDefault()})),document.getElementById("openDiv").addEventListener("dragenter",(()=>{document.getElementById("openDiv").classList.add("dropNotice")}));for(let e of document.getElementsByClassName("optionId"))void 0!==e.childNodes[1]&&"img"===e.childNodes[1].tagName.toLowerCase()&&e.addEventListener("mouseleave",(()=>{e.childNodes[1].classList.add("closeAnimationTool"),setTimeout((()=>{e.childNodes[1].classList.remove("closeAnimationTool")}),350)}));-1!==(navigator.language||navigator.userLanguage).indexOf("it")&&-1===window.location.href.indexOf("nolang")&&"yes"!==localStorage.getItem("PDFPointer-nolang")&&fetch("./translationItems/it.json").then((e=>{e.json().then((e=>{for(let t of document.querySelectorAll("[data-translate]"))t.textContent=e[t.getAttribute("data-translate")];y=e.globalTranslations,topAlert(y.changeLang,"differentlang",!0)}))})),document.querySelector("[data-translate=customThemeBtn]").addEventListener("click",(()=>{window.location.href="./themeCreator/create.html"})),null!==localStorage.getItem("PDFPointer-selectedtheme")&&null!==document.querySelector(`[data-themerefer=${localStorage.getItem("PDFPointer-selectedtheme")}]`)&&document.querySelector(`[data-themerefer=${localStorage.getItem("PDFPointer-selectedtheme")}]`).click(),document.getElementById("alertNumberDuration").addEventListener("change",(()=>{I.changeItems.alertInt=document.getElementById("alertNumberDuration").value})),document.querySelector("[data-translate=resetTip]").addEventListener("click",(()=>{localStorage.setItem("PDFPointer-notshow","")}));for(let e of document.getElementsByClassName("button"))1!==parseInt(e.getAttribute("data-customAnimate"))&&(e.addEventListener("mouseenter",(()=>{e.classList.remove("hoverEnd"),e.classList.add("hoverStart")})),e.addEventListener("mouseleave",(()=>{e.classList.remove("hoverStart"),e.classList.add("hoverEnd")})));function PWAHide(){document.getElementById("pwaPromote").remove();for(let e of document.querySelectorAll("[data-card=opencard]"))e.style.width="100%"}window.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),P=e})),document.querySelector("[data-translate=installBtn]").addEventListener("click",(()=>{P.prompt(),P.userChoice.then((e=>{"accepted"===e.outcome&&PWAHide()}))})),window.matchMedia("(display-mode: standalone)").matches&&PWAHide();for(let e of document.querySelectorAll("[data-progress]"))e.addEventListener("click",(()=>{var t;0===(t=parseInt(e.getAttribute("data-progress")))?(document.getElementById(`intro${t+1}`).classList.add("animateFirstIntroduction"),document.getElementById(`innerContents${t+1}`).classList.add("animateFirstIntroduction")):(document.getElementById(`intro${t+1}`).classList.add("animateSecondIntroduction"),document.getElementById(`innerContents${t+1}`).classList.add("animateSecondIntroduction")),document.getElementById(`innerContents${t+1}`).style.opacity=0,setTimeout((()=>{document.getElementById(`intro${t+1}`).style.display="none",document.getElementById(`intro${t+2}`).style.display="block",document.getElementById(`intro${t+2}`).style.opacity=1}),500)}));document.querySelector("[data-translate=endTour]").addEventListener("click",(()=>{document.getElementById("introContainer").style.opacity=0,localStorage.setItem("PDFPointer-endtour","true"),setTimeout((()=>{document.getElementById("introContainer").style.display="none"}),500)})),null===localStorage.getItem("PDFPointer-endtour")&&(document.getElementById("introContainer").style.display="inline",document.getElementById("introContainer").style.opacity=1);for(let e of document.querySelectorAll("[data-customAnimate='1']"))hoverItem(e);let A=[[document.getElementById("pointerSelectionDiv"),document.getElementById("pointerCheck"),document.getElementById("pointerContainer"),"changeItems.pointerColorEnabled"],[document.getElementById("alertContainer"),document.getElementById("alertCheck"),document.getElementById("alertMain"),"changeItems.showTips"]];for(let e=0;e<A.length;e++)switchSubsectionShow(A[e][0],A[e][1],A[e][2],A[e][3]);function switchSubsectionShow(e,t,n,o){let a=I,l=o.split(".");for(let e=0;e<l.length-1;e++)a=a[l[e]];t.addEventListener("input",(()=>{a[l[l.length-1]]=t.checked,t.checked?(n.style.maxHeight=`${n.offsetHeight}px`,e.style.display="inline",n.style.maxHeight=`${n.offsetHeight}px`,setTimeout((()=>{e.style.opacity=1}),50)):(e.style.opacity=0,setTimeout((()=>{n.style.maxHeight=n.getAttribute("defaultHeight"),setTimeout((()=>{e.style.display="none"}),150)}),350))}))}document.getElementById("pointerColorSelector").addEventListener("input",(()=>{I.changeItems.pointerColorColor=document.getElementById("pointerColorSelector").value})),document.querySelector("[data-translate=exportColor]").addEventListener("click",(()=>{let e=document.createElement("a");e.href=URL.createObjectURL(new Blob([JSON.stringify(I.availableHighlightColors)],{type:"text/plain"})),e.download="colors-export.json",e.click()})),document.querySelector("[data-translate=importColor]").addEventListener("click",(()=>{let e=document.createElement("input");e.type="file",e.onchange=()=>{let t=new FileReader;t.onload=()=>{let e=JSON.parse(t.result);I.availableHighlightColors={currentColor:[255,0,0,255]};for(let t in e){if("currentColor"===t)continue;let n=!0;for(let o of e[t])try{(parseInt(o)>255||parseInt(o)<0)&&(n=!1)}catch(e){console.warn(e),n=!1}n&&(I.availableHighlightColors[t]=e[t])}localStorage.setItem("PDFPointer-customColors",JSON.stringify(I.availableHighlightColors)),alert("Colors restored. The page will be refreshed."),location.reload()},t.readAsText(e.files[0])},e.click()})),document.querySelector("[data-translate=resetColor]").addEventListener("click",(()=>{I.availableHighlightColors={Red:[255,0,0,255],Blue:[0,0,255,255],Green:[0,255,0,255],currentColor:[255,0,0,255]},localStorage.setItem("PDFPointer-customColors",JSON.stringify(I.availableHighlightColors)),alert("Colors restored. The page will be refreshed."),location.reload()})),document.querySelector("[data-translate=changeZoom]").addEventListener("click",(()=>{dialogGeneralAnimation("settings",!1),setTimeout((()=>{dialogGeneralAnimation("zoomChooseContainer",!0)}),1150)})),window.scrollTo({top:0,behavior:"smooth"});for(let e of document.querySelectorAll("video"))e.addEventListener("error",(()=>{let t=e.parentElement;e.remove(),t.textContent="An error occourred while streaming the video :("}));let F=!1;document.body.addEventListener("wheel",(()=>{if("hidden"!==document.getElementById("toolMain").style.visibility)if(x)document.getElementById("generalToolContainer").style="position: fixed; z-index: 9999997;";else if(window.scrollY>document.getElementById("generalToolContainer").getBoundingClientRect().bottom+document.getElementById("generalToolContainer").getBoundingClientRect().top){if(F)return;F=!0,document.getElementById("generalToolContainer").style="position: fixed; z-index: 9999997; top: 15px;"}else{if(!F)return;document.getElementById("generalToolContainer").style="",F=!1}}));for(let t of document.querySelectorAll("[data-videofetch]"))fetch(`${e}assets/${t.getAttribute("data-videofetch")}`).then((e=>{e.blob().then((e=>{t.src=URL.createObjectURL(e)})).catch((e=>{console.warn(e)}))})).catch((e=>{console.warn(e)}));document.getElementById("welcomeClick").addEventListener("click",(()=>{window.location.reload()}));try{document.getElementById("jsContinue").addEventListener("click",(()=>{document.getElementById("jsPromptAsk").remove()})),document.getElementById("jsPromptAsk").remove()}catch(e){console.log("Hello World! :D")}-1!==window.location.href.indexOf("nolang")&&localStorage.setItem("PDFPointer-nolang","yes"),-1!==window.location.href.indexOf("itlang")&&(localStorage.setItem("PDFPointer-nolang","no"),window.location.href=window.location.href.substring(0,window.location.href.indexOf("?itlang"))),document.getElementById("langOption").addEventListener("input",(()=>{switch(document.getElementById("langOption").value){case"en":localStorage.setItem("PDFPointer-nolang","yes");break;case"it":localStorage.setItem("PDFPointer-nolang","no")}let e=`${window.location.href}?`;window.location.href=window.location.href.substring(0,e.indexOf("?"))}));let O=[["moveZoomCheck","resizeCanvasCheck"],["changeItems.moveZoom","changeItems.resizeCanvas"]];for(let e=0;e<O[0].length;e++)document.getElementById(O[0][e]).addEventListener("input",(()=>{let t=I,n=O[1][e].split(".");for(let e=0;e<n.length-1;e++)t=t[n[e]];t[n[n.length-1]]=document.getElementById(O[0][e]).checked}));function showResizeCanvasBtn(e){document.querySelector("[data-action=expand]").style.display=e,document.querySelector("[data-action=contract]").style.display=e}function manageBackground(){function dontShow(e){let t=[document.getElementById("ytlinkask"),document.getElementById("imgAsk")];e&&t.reverse(),1!==t[1].style.opacity?(t[1].style.opacity=0,setTimeout((()=>{t[1].style.display="none",t[0].style.display="inline",setTimeout((()=>{t[0].style.opacity=1}),15)}),400)):(t[0].style.display="inline",setTimeout((()=>{t[0].style.opacity=1}),15)),document.getElementById("styleItem").style.display="inline",setTimeout((()=>{document.getElementById("styleItem").style.opacity="1"}),15)}switch(localStorage.setItem("PDFPointer-backgroundId",document.getElementById("backgroundOptions").value),parseInt(document.getElementById("backgroundOptions").value)){case 1:dontShow(),null!==document.getElementById("imgRefer")&&document.getElementById("imgRefer").remove(),null!==localStorage.getItem("PDFPointer-ytLink")&&document.querySelector("[data-translate=applyyt]").click();break;case 2:dontShow(!0),document.querySelector(".video-background").style.display="none",document.getElementById("ytframe").src="",null!==localStorage.getItem("PDFPointer-customImg")&&imgEmbed();break;default:document.getElementById("ytlinkask").style.opacity=0,document.getElementById("imgAsk").style.opacity=0,null!==document.getElementById("imgRefer")&&document.getElementById("imgRefer").remove(),document.getElementById("ytframe").src="",document.getElementById("styleItem").style.opacity=0,setTimeout((()=>{document.getElementById("ytlinkask").style.display="none",document.getElementById("styleItem").style.display="none",document.getElementById("imgAsk").style.display="none"}),400)}}function ytEmbed(){document.querySelector(".video-background").style.display="block";let e="?";-1!==localStorage.getItem("PDFPointer-ytLink").indexOf("?")&&(e="&"),document.getElementById("ytframe").src=`https://www.youtube-nocookie.com/embed/${localStorage.getItem("PDFPointer-ytLink")}${e}autoplay=1&mute=1`,generateFilters()}function imgEmbed(){null!==document.getElementById("imgRefer")&&document.getElementById("imgRefer").remove();let e=document.createElement("img");e.style="z-index: -1; position: fixed; width: 100vw; height: 100vh; margin: 0; top: 0; left: 0; object-fit: cover;",e.src=localStorage.getItem("PDFPointer-customImg"),e.id="imgRefer",document.body.append(e),generateFilters()}function generateFilters(){let e=`blur(${document.getElementById("blurRange").value}px) brightness(${document.getElementById("brightRange").value}%)`;null!==document.getElementById("imgRefer")&&(document.getElementById("imgRefer").style.filter=e),null!==document.getElementById("imgRefer")&&(document.getElementById("imgRefer").style.webkitFilter=e),document.querySelector(".video-background").style.filter=e,document.querySelector(".video-background").style.webkitFilter=e}if(document.getElementById("resizeCanvasCheck").addEventListener("input",(()=>{document.getElementById("resizeCanvasCheck").checked?showResizeCanvasBtn("block"):showResizeCanvasBtn("none"),setupTranlsation()})),I.changeItems.resizeCanvas&&localStorage.getItem("PDFPointer-resizecanvas")||showResizeCanvasBtn("none"),document.querySelector("[data-action=expand]").addEventListener("click",(()=>{m+=5,canvasPDF(i.page)})),document.querySelector("[data-action=contract]").addEventListener("click",(()=>{m-=5,canvasPDF(i.page)})),document.querySelector("[data-translate=applyyt]").addEventListener("click",(()=>{let e=document.getElementById("ytLinkValue").value;-1!==e.indexOf("&")&&(e=e.substring(0,e.indexOf("&"))),-1!==e.indexOf("watch?v=")?localStorage.setItem("PDFPointer-ytLink",e.substring(e.indexOf("watch?v=")).replace("watch?v=","")):-1!==e.indexOf("playlist?list=")?localStorage.setItem("PDFPointer-ytLink",`videoseries?list=${e.substring(e.indexOf("playlist?list=")).replace("playlist?list=","")}`):-1!==e.indexOf("youtu.be")&&localStorage.setItem("PDFPointer-ytLink",e.substring(e.lastIndexOf("/")+1)),ytEmbed()})),document.getElementById("backgroundOptions").addEventListener("input",(()=>{manageBackground()})),document.querySelector("[data-translate=chooseimg]").addEventListener("click",(()=>{let e=document.createElement("input");e.type="file",e.onchange=()=>{let t=new FileReader;t.onload=()=>{let e=document.createElement("img");e.onload=()=>{let t=1.5;!function generateImage(){let n=document.createElement("canvas"),o=window.devicePixelRatio||1;n.width>n.height?(n.height=window.screen.height*t*o,n.width=e.width*n.height/e.height):(n.width=window.screen.width*t*o,n.height=e.height*n.width/e.width),n.getContext("2d").drawImage(e,0,0,n.width,n.height);let a=n.toDataURL("image/jpeg",.5);if(a.length>1333333)return t-=.15,void generateImage();localStorage.setItem("PDFPointer-customImg",a),imgEmbed()}()},e.src=t.result},t.readAsDataURL(e.files[0])},e.click()})),null===localStorage.getItem("PDFPointer-ytLink")&&localStorage.setItem("PDFPointer-ytLink","videoseries?list=PLuu93Gnhjs5BJ-kf5IxMwPGftIFqlMVZu"),-1!==window.location.href.indexOf("ytconcentration")&&localStorage.setItem("PDFPointer-backgroundId","1"),document.getElementById("blurRange").addEventListener("input",(()=>{localStorage.setItem("PDFPointer-blur",document.getElementById("blurRange").value),generateFilters()})),document.getElementById("brightRange").addEventListener("input",(()=>{localStorage.setItem("PDFPointer-bright",document.getElementById("brightRange").value),generateFilters()})),null!==localStorage.getItem("PDFPointer-backgroundId")){1===parseInt(localStorage.getItem("PDFPointer-backgroundId"))?ytEmbed():2===parseInt(localStorage.getItem("PDFPointer-backgroundId"))&&imgEmbed(),document.getElementById("backgroundOptions").value=localStorage.getItem("PDFPointer-backgroundId");let e=[["PDFPointer-ytLink","PDFPointer-blur","PDFPointer-bright"],[document.getElementById("ytLinkValue"),document.getElementById("blurRange"),document.getElementById("brightRange")]];for(let t=0;t<e.length;t++)null!==localStorage.getItem(e[0][t])&&(e[1][t].value=localStorage.getItem(e[0][t]));manageBackground(),generateFilters()}function createRange(e,t,n,o,a){let l=document.createElement("input");return l.type="range",l.max=e,l.min=n,l.id=o,l.step=a,l.value=t,l.classList.add("fillWidth"),l}document.querySelector("[data-action=downloadAsImg]").addEventListener("click",(()=>{!function createSaveImgDropdown(){if(I.showAlert.downloadImg)return;let e=createDropdown(document.querySelector("[data-action=downloadAsImg]"),!0,"downloadImg"),t=document.createElement("select");t.id="exportSelect",t.classList.add("fillWidth");for(let e of["JPG","PNG","WebP"]){let n=document.createElement("option");n.textContent=e,n.value=e,t.append(n)}if(t.firstChild.selected="true",-1!==navigator.userAgent.toLowerCase().indexOf("safari")&&-1===navigator.userAgent.toLowerCase().indexOf("chrome")){t.childNodes[2].disabled=!0;let e=document.createElement("style");e.innerHTML="input[type='range'],input[type='range']::-webkit-slider-runnable-track,input[type='range']::-webkit-slider-thumb {-webkit-appearance: none;border-radius: 15px;}",document.head.append(e)}let n=document.createElement("l");n.textContent=y.exportInformation;let o=document.createElement("div");o.classList.add("vertcenter","opacityRemove");let a=document.createElement("div");a.classList.add("optionId","button","hoverEnd");let l=document.createElement("div");l.classList.add("vertcenter"),l.textContent=y.save,a.append(l),o.append(a);let r=document.createElement("div");r.classList.add("opacityRemove");let c=document.createElement("l");c.textContent=y.qualityInfo;let d=createRange("1","0.9","0.01","exportSlider","0.01");t.addEventListener("input",(()=>{"PNG"===t.value?(r.style.opacity="0",setTimeout((()=>{"0"===r.style.opacity&&(r.style.display="none")}),400)):(r.style.display="block",setTimeout((()=>{r.style.opacity="1"}),15))}));let s=document.createElement("l");s.textContent=y.customExport;let m=document.createElement("i");m.textContent=y.customItalic,m.style="font-size: 8pt";let u=document.createElement("input");u.type="text",u.classList.add("fillWidth"),o.style.opacity="1",u.addEventListener("input",(()=>{let e=!/^[0-9,-]*$/.test(u.value);if(!e)for(let t of u.value.split(","))t.split("-").length>2&&(e=!0);o.style.opacity=e?"0.4":"1"})),o.addEventListener("click",(()=>{if("1"===o.style.opacity){if(I.export.processPage=[],I.export.pageId=0,""===u.value)I.export.processPage=[i.page];else for(let e of u.value.split(","))if(-1!==e.indexOf("-"))for(let t=parseInt(e.substring(0,e.indexOf("-")));t<parseInt(e.substring(e.lastIndexOf("-")+1))+1;t++)I.export.processPage.push(t);else I.export.processPage.push(parseInt(e));exportCanvas()}})),r.append(c,document.createElement("br"),d);let g=document.createElement("l");g.textContent=y.resize;let p=document.createElement("i");p.textContent=y.resizeItalic,p.style="font-size: 8pt";let h=createRange("5","3","0.1","resizeSlider","0.1"),f=document.createElement("label");f.classList.add("switch");let v=document.createElement("input");v.type="checkbox",v.id="zipExport";let E=document.createElement("span");E.classList.add("slider","round");let w=document.createElement("l");w.textContent=y.saveZip,f.append(v,E),f.style.marginRight="10px";for(let e of[t,o,d,u,h,E])hoverItem(e);e.append(document.createElement("br"),document.createElement("br"),n,document.createElement("br"),t,document.createElement("br"),document.createElement("br"),r,document.createElement("br"),document.createElement("br"),s,document.createElement("br"),m,document.createElement("br"),u,document.createElement("br"),document.createElement("br"),g,document.createElement("br"),p,document.createElement("br"),h,document.createElement("br"),document.createElement("br"),f,w,document.createElement("br"),document.createElement("br"),o),document.body.append(e)}()}));let z=new JSZip;function zipDownload(){z.generateAsync({type:"blob"}).then((e=>{let t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=`${c.substring(0,c.lastIndexOf("."))}-img.zip`,t.click(),z=new JSZip}))}function exportCanvas(){let e=window.devicePixelRatio||1,t=I.export.processPage[I.export.pageId];i.promise.getPage(t).then((function(n){I.export.pageId++;let o=n.getViewport({scale:1}),a=greatViewport(o);o=n.getViewport({scale:a*parseFloat(document.getElementById("resizeSlider").value)});let l=setUpCanvas(document.createElement("canvas"),o,!0),i=1!==e?[e,0,0,e,0,0]:null,r={canvasContext:l.getContext("2d"),transform:i,viewport:o};n.render(r).promise.then((()=>{let e=document.querySelectorAll("[data-page]"),n=0;function advance(){n++,n<e.length?divLoop():function downloadCanvas(){let e=`${c.substring(0,c.lastIndexOf("."))}-Page-${t}.${document.getElementById("exportSelect").value.toLowerCase()}`;if(document.getElementById("zipExport").checked){switch(document.getElementById("exportSelect").value.toLowerCase()){case"jpg":z.file(e,l.toDataURL("image/jpeg",parseFloat(document.getElementById("exportSlider").value)).replace(/^data:.+;base64,/,""),{base64:!0});break;case"webp":z.file(e,l.toDataURL("image/webp",parseFloat(document.getElementById("exportSlider").value)).replace(/^data:.+;base64,/,""),{base64:!0});break;default:z.file(e,l.toDataURL("image/png").replace(/^data:.+;base64,/,""),{base64:!0})}I.export.pageId<I.export.processPage.length?exportCanvas():zipDownload()}else{let t=document.createElement("a");switch(document.getElementById("exportSelect").value.toLowerCase()){case"jpg":t.href=l.toDataURL("image/jpeg",parseFloat(document.getElementById("exportSlider").value));break;case"webp":t.href=l.toDataURL("image/webp",parseFloat(document.getElementById("exportSlider").value));break;default:t.href=l.toDataURL("image/png")}t.download=e,-1!==navigator.userAgent.toLowerCase().indexOf("safari")&&-1===navigator.userAgent.toLowerCase().indexOf("chrome")?setTimeout((()=>{t.click(),I.export.pageId<I.export.processPage.length&&exportCanvas()}),80*Math.random()+20):(t.click(),I.export.pageId<I.export.processPage.length&&exportCanvas())}}()}function divLoop(){let o=e[n];if(void 0!==o&&parseInt(o.getAttribute("data-page"))===t&&""!==o.innerHTML){let e=document.createElement("img");e.width=l.width,e.height=l.height,e.addEventListener("load",(()=>{l.getContext("2d").drawImage(e,0,0,l.width,l.height),advance()})),e.src=URL.createObjectURL(new Blob([o.innerHTML.replaceAll('"',"'")],{type:"image/svg+xml"}))}else advance()}divLoop()})).catch((e=>{I.export.pageId++,console.warn(e),void 0===I.export.processPage[I.export.pageId]&&document.getElementById("zipExport").checked?zipDownload():void 0!==I.export.processPage[I.export.pageId]&&exportCanvas()}))})).catch((e=>{I.export.pageId++,console.warn(e),void 0===I.export.processPage[I.export.pageId]&&document.getElementById("zipExport").checked?zipDownload():void 0!==I.export.processPage[I.export.pageId]&&exportCanvas()}))}function hoverItem(e){e.addEventListener("mouseenter",(()=>{e.classList.remove("closeAnimationTool"),e.classList.add("btnTourAnimate")})),e.addEventListener("mouseleave",(()=>{e.classList.remove("btnTourAnimate"),e.classList.add("closeAnimationTool")}))}function safariFixSelect(){if(-1!==navigator.userAgent.toLowerCase().indexOf("safari")&&-1===navigator.userAgent.toLowerCase().indexOf("chrome")){let e=hexToRgbNew(getComputedStyle(document.body).getPropertyValue("--text").replace("#","")).split(",");document.getElementById("safariStyle").innerHTML=`select {-webkit-appearance: none; background-image: url("data:image/svg+xml;utf8,<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='24' height='24' viewBox='0 0 24 24'><path fill='rgb(${e[0]},${e[1]},${e[2]}' d='M7.406 7.828l4.594 4.594 4.594-4.594 1.406 1.406-6 6-6-6z'></path></svg>"); background-position: 100% 50%; background-repeat: no-repeat; font-size: 10pt}`}}function setupTranlsation(){document.getElementById("hoverContainer").innerHTML="";for(let e of document.querySelectorAll("[data-action]")){let t=document.createElement("div");t.classList.add("hoverTool"),x?(t.style.top=e.getBoundingClientRect().bottom-25+"px",t.style.left=`${e.getBoundingClientRect().right+12}px`):(t.style.top=`${e.getBoundingClientRect().bottom+12}px`,t.style.left=e.getBoundingClientRect().left-25+"px");let n=document.createElement("div");n.classList.add("hoverInner"),n.textContent=y.hoverTranslation[e.getAttribute("data-action")],e.addEventListener("mouseenter",(()=>{t.style.display="block",setTimeout((()=>{t.style.opacity="1"}),25)})),e.addEventListener("mouseleave",(()=>{t.style.opacity="0",setTimeout((()=>{t.style.display="none"}),350)})),t.append(n),document.getElementById("hoverContainer").append(t)}}safariFixSelect(),document.getElementById("ytLinkValue").type="text"})();